<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Seccion Desplegable</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Lato', sans-serif;
            background: #ffcba4;
        }
        .btn-toggle {
            font-size: 24px;
            font-weight: bold;
            color: #000;
            background: #FFDC00;
            text-align: center;
            cursor: pointer;
        }
        .count-products {
            position: absolute;
            top: 0;
            right: 0;
            background-color: orange;
            color: white;
            width: 25px;
            height: 25px;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 50%;
            transform: translate(50%, -50%);
        }
        .container-cart-products {
            position: absolute;
            top: 50px;
            right: 0;
            background: rgb(255, 111, 0);
            background: radial-gradient(circle, rgba(255, 111, 0, 1) 23%, rgba(245, 255, 0, 1) 100%);
            width: 400px;
            z-index: 1;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.20);
            border-radius: 10px;
        }
        .ir-arriba {
            display: none;
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 40px;
            height: 40px;
            text-align: center;
            background-color: #ffe180;
            color: white;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.2s;
        }
        .ir-arriba:hover {
            background-color: orangered;
        }
        .item img {
            transition: all .5s;
        }
        .item:hover img {
            transform: scale(1.2);
        }
    </style>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
</head>
<body>
    <section class="seccionToggle d-none bg-white text-primary py-5 text-center">
        <div class="container">
            <h2>Estamos para darte el mejor servicio</h2>
            <p>comunicate con nosotros</p>
            <button class="btn btn-outline-primary">
                <a href="https://www.facebook.com/" class="text-primary">Siguenos!</a>
            </button>
        </div>
    </section>

    <a href="#" id="btn-toggle" class="btn-toggle d-block p-2 my-2">Abrir</a>

    <div class="main">
        <div class="container">
            <input type="search" class="form-control my-3 search-bar" placeholder="Buscar productos">
            <header class="d-flex justify-content-between align-items-center">
                <h1>Heladeria</h1>
                <div class="container-icon position-relative">
                    <div class="container-cart-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="icon-cart" style="width: 40px; height: 40px; cursor: pointer;">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M15.75 10.5V6a3.75 3.75 0 10-7.5 0v4.5m11.356-1.993l1.263 12c.07.665-.45 1.243-1.119 1.243H4.25a1.125 1.125 0 01-1.12-1.243l1.264-12A1.125 1.125 0 015.513 7.5h12.974c.576 0 1.059.435 1.119 1.007zM8.625 10.5a.375.375 0 11-.75 0 .375.375 0 01.75 0zm7.5 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z"/>
                        </svg>
                        <div class="count-products">
                            <span id="contador-productos">0</span>
                        </div>
                    </div>
                    <div class="container-cart-products d-none">
                        <div class="row-product d-none">
                            <div class="cart-product">
                                <div class="info-cart-product d-flex justify-content-between">
                                    <span class="cantidad-producto-carrito">1</span>
                                    <p class="titulo-producto-carrito">Helado Vegano</p>
                                    <span class="precio-producto-carrito">$80</span>
                                </div>
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="icon-close" style="width: 25px; height: 25px; cursor: pointer;">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M6 18L18 6M6 6l12 12"/>
                                </svg>
                            </div>
                        </div>
                        <div class="cart-total d-none d-flex justify-content-between align-items-center p-3">
                            <h3>Total:</h3>
                            <span class="total-pagar">$200</span>
                        </div>
                        <p class="cart-empty text-center">El carrito está vacío</p>
                    </div>
                </div>
            </header>
            <div class="container-items row">
                <div class="item col-md-4 mb-4">
                    <figure>
                        <img src="producto5.jpg" class="img-fluid">
                    </figure>
                    <div class="info-product text-center">
                        <h2>Helado Vegano</h2>
                        <p class="price">$80</p>
                        <button class="btn btn-warning btn-add-cart">Añadir al carrito</button>
                    </div>
                </div>
                <div class="item col-md-4 mb-4">
                    <figure>
                        <img src="producto4.jpg" class="img-fluid">
                    </figure>
                    <div class="info-product text-center">
                        <h2>Mordisko</h2>
                        <p class="price">$20</p>
                        <button class="btn btn-warning btn-add-cart">Añadir al carrito</button>
                    </div>
                </div>
                <div class="item col-md-4 mb-4">
                    <figure>
                        <img src="producto3.jpg" class="img-fluid">
                    </figure>
                    <div class="info-product text-center">
                        <h2>Helado Napolitano</h2>
                        <p class="price">$50</p>
                        <button class="btn btn-warning btn-add-cart">Añadir al carrito</button>
                    </div>
                </div>
                <div class="item col-md-4 mb-4">
                    <figure>
                        <img src="producto2.jpg" class="img-fluid">
                    </figure>
                    <div class="info-product text-center">
                        <h2>Helado Chispas chocolate</h2>
                        <p class="price">$90</p>
                        <button class="btn btn-warning btn-add-cart">Añadir al carrito</button>
                    </div>
                </div>
                <div class="item col-md-4 mb-4">
                    <figure>
                        <img src="producto1.jpg" class="img-fluid">
                    </figure>
                    <div class="info-product text-center">
                        <h2>Helado Vainilla</h2>
                        <p class="price">$50</p>
                        <button class="btn btn-warning btn-add-cart">Añadir al carrito</button>
                    </div>
                </div>
            </div>
            <div class="search-results"></div>
        </div>
        <a href="#" class="ir-arriba" title="Volver arriba">
            <span class="fa-stack">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-arrow-up fa-stack-1x fa-inverse"></i>
            </span>
        </a>
    </div>
    <script>
        const btnCart = document.querySelector('.container-cart-icon');
        const containerCartProducts = document.querySelector('.container-cart-products');

        btnCart.addEventListener('click', () => {
            containerCartProducts.classList.toggle('d-none');
        });

        const cartInfo = document.querySelector('.cart-product');
        const rowProduct = document.querySelector('.row-product');
        const productsList = document.querySelector('.container-items');
        const totalValue = document.querySelector('.total-pagar');
        const countProducts = document.querySelector('#contador-productos');
        const cartEmpty = document.querySelector('.cart-empty');
        const cartTotal = document.querySelector('.cart-total');

        let allProducts = [];

        productsList.addEventListener('click', e => {
            if (e.target.classList.contains('btn-add-cart')) {
                const product = e.target.parentElement;
                const productName = product.querySelector('h2').textContent;
                const productPrice = product.querySelector('p').textContent;

                const newProduct = {
                    name: productName,
                    price: productPrice,
                    quantity: 1
                };

                addProductToCart(newProduct);
            }
        });

        rowProduct.addEventListener('click', e => {
            if (e.target.classList.contains('icon-close')) {
                const product = e.target.parentElement;
                const productName = product.querySelector('p').textContent;

                removeProductFromCart(productName);
            }
        });

        function addProductToCart(product) {
            const productExists = allProducts.some(prod => prod.name === product.name);

            if (productExists) {
                const products = allProducts.map(prod => {
                    if (prod.name === product.name) {
                        prod.quantity++;
                        return prod;
                    } else {
                        return prod;
                    }
                });
                allProducts = [...products];
            } else {
                allProducts = [...allProducts, product];
            }

            updateCart();
        }

        function removeProductFromCart(productName) {
            allProducts = allProducts.filter(product => product.name !== productName);
            updateCart();
        }

        function updateCart() {
            if (allProducts.length > 0) {
                rowProduct.classList.remove('d-none');
                cartTotal.classList.remove('d-none');
                cartEmpty.classList.add('d-none');
            } else {
                rowProduct.classList.add('d-none');
                cartTotal.classList.add('d-none');
                cartEmpty.classList.remove('d-none');
            }

            rowProduct.innerHTML = '';

            let total = 0;
            let totalOfProducts = 0;

            allProducts.forEach(product => {
                const containerProduct = document.createElement('div');
                containerProduct.classList.add('cart-product', 'd-flex', 'justify-content-between', 'align-items-center', 'p-3');
                containerProduct.innerHTML = `
                    <div class="info-cart-product">
                        <span class="cantidad-producto-carrito">${product.quantity}</span>
                        <p class="titulo-producto-carrito">${product.name}</p>
                        <span class="precio-producto-carrito">${product.price}</span>
                    </div>
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="icon-close" style="width: 25px; height: 25px; cursor: pointer;">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                `;

                rowProduct.append(containerProduct);

                total += parseInt(product.quantity * product.price.slice(1));
                totalOfProducts += product.quantity;
            });

            totalValue.innerText = `$${total}`;
            countProducts.innerText = totalOfProducts;
        }

        $(document).ready(function () {
            $("#btn-toggle").click(function (event) {
                event.preventDefault();
                $(".seccionToggle").toggleClass("d-none");
            });

            $(".ir-arriba").click(function () {
                $("body, html").animate({
                    scrollTop: "0px"
                }, 300);
            });

            $(window).scroll(function () {
                if ($(this).scrollTop() > 0) {
                    $(".ir-arriba").fadeIn(300);
                } else {
                    $(".ir-arriba").fadeOut(300);
                }
            });

            $(".search-bar").on("input", function () {
                const value = $(this).val().toLowerCase();
                $(".container-items .item").filter(function () {
                    $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1);
                });
            });
        });

      
        document.addEventListener('keypress', (event) => {
            const key = event.key.toLowerCase();

            switch (key) {
                case 'w':
                    window.scrollBy(0, -50); 
                    break;
                case 's':
                    window.scrollBy(0, 50); 
                    break;
                default:
                  
                    break;
            }
        });
    </script>
</body>
</html>
